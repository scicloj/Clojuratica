<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Wolframite for scientists II (Cavity physics) – Wolframite Documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./for_developers.index.html" rel="next">
<link href="./for_scientists.index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./for_scientists.index.html">Tutorials for scientists</a></li><li class="breadcrumb-item"><a href="./for_scientists.cavity_physics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Wolframite Documentation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Wolframite</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quickstart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quickstart</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gotchas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Gotchas…</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials for scientists</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_scientists.index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_scientists.cavity_physics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials for developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_developers.index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Wolframite for developers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">FAQ</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#cavities" id="toc-cavities" class="nav-link active" data-scroll-target="#cavities"><span class="header-section-number">6.1</span> Cavities?</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">6.2</span> Setup</a></li>
  <li><a href="#interfaces" id="toc-interfaces" class="nav-link" data-scroll-target="#interfaces"><span class="header-section-number">6.3</span> Interfaces</a></li>
  <li><a href="#observables" id="toc-observables" class="nav-link" data-scroll-target="#observables"><span class="header-section-number">6.4</span> Observables</a></li>
  <li><a href="#observables-with-loss" id="toc-observables-with-loss" class="nav-link" data-scroll-target="#observables-with-loss"><span class="header-section-number">6.5</span> Observables with loss</a></li>
  <li><a href="#approximations" id="toc-approximations" class="nav-link" data-scroll-target="#approximations"><span class="header-section-number">6.6</span> Approximations</a></li>
  <li><a href="#the-cavity-field" id="toc-the-cavity-field" class="nav-link" data-scroll-target="#the-cavity-field"><span class="header-section-number">6.7</span> The cavity field</a></li>
  <li><a href="#visualised" id="toc-visualised" class="nav-link" data-scroll-target="#visualised"><span class="header-section-number">6.8</span> Visualised</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="header-section-number">7</span> Acknowledgements</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./for_scientists.index.html">Tutorials for scientists</a></li><li class="breadcrumb-item"><a href="./for_scientists.cavity_physics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="for_scientists.cavity_physics_files/md-default0.js" type="text/javascript"></script>
<script src="for_scientists.cavity_physics_files/md-default1.js" type="text/javascript"></script>
<script src="for_scientists.cavity_physics_files/katex2.js" type="text/javascript"></script>
<p><link href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" rel="stylesheet" type="text/css"></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">ns</span> for-scientists.cavity-physics</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The second part of Wolframite for scientists. Here, we consider a real physics problem as a demonstration of how one might use Wolframite in practice."</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:require</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   [clojure.math <span class="at">:as</span> math]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   [scicloj.kindly.v4.kind <span class="at">:as</span> k]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   [wolframite.core <span class="at">:as</span> wl]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   [wolframite.tools.hiccup <span class="at">:as</span> wh]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   [wolframite.wolfram <span class="at">:as</span> w]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Congratulations if you made it here from part I. In this part, rather than introducing Wolframite, <em>per se</em>, we’re going to solve a physics problem, such that Wolframite is simply a tool to get the job done.</p>
<p>First of all, we redefine the shortcuts that we used in the previous part, before introducing the problem at hand.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> aliases </span><span class="co">; </span><span class="al">NOTE</span><span class="co">: These aliases are already included by default</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  '{** Power</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    ++ Conjugate</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    x&gt; Replace</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    x&gt;&gt; ReplaceAll</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    &lt;_&gt; Expand</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    &lt;&lt;_&gt;&gt; ExpandAll</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ++&lt;_&gt; ComplexExpand</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    &gt;_&lt; Simplify</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    &gt;&gt;_&lt;&lt; FullSimplify</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    ⮾ NonCommutativeMultiply</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    √ Sqrt</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    ∫ Integrate})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(wl/restart {<span class="at">:aliases</span> aliases})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> eval-&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the threading macro to automatically pass the result to wolframite eval."</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;</span> <span class="at">~@xs</span> wl/eval))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> TeX</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UX fix. Passes the Wolfram expression to ToString[TeXForm[...]], as the unsuspecting coder might not realise that 'ToString' is necessary."</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  [tex-form]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  (w/ToString (w/TeXForm tex-form)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> TeX-&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the thread-first macro to automatically eval and prepare the expression for TeX display."</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;</span> <span class="at">~@xs</span> TeX wl/eval k/tex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> eval-&gt;&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the threading macro to automatically pass the result to wolframite eval."</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;&gt;</span> <span class="at">~@xs</span> wl/eval))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> TeX-&gt;&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the thread-last macro to automatically eval and prepare the expression for TeX display."</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;&gt;</span> <span class="at">~@xs</span> TeX wl/eval k/tex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> </span>||<span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The intensity: the value times the conjugate of the value or, equivalently, the absolute value squared."</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  [x]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  (w/* x (w/++ x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cavities" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="cavities"><span class="header-section-number">6.1</span> Cavities?</h2>
<p>Outside of the operating room, the most common notion of cavities is, what we might otherwise call, an optical resonator. One way of looking at it, although quantum mechanics makes this more difficult, is that an optical cavity is simply just a light trap, such that once light gets in, it bounces around for a while and then leaves.</p>
<p>For demo purposes, our question then is ‘how can we model this?’ and ‘how does the light intensity, inside the cavity, depend on some experimental variables’?</p>
</section>
<section id="setup" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="setup"><span class="header-section-number">6.2</span> Setup</h2>
<p>Assuming a simple two-mirror setup, with independent reflectivities and transmission, the system can be described as a ray oscillating between four key interfaces, as illustrated in the figure.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(k/hiccup [<span class="at">:img</span> {<span class="at">:src</span> <span class="st">"notebooks/for_scientists/Cavity-MirrorScatteringLoss.png"</span>}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<img src="notebooks/for_scientists/Cavity-MirrorScatteringLoss.png">
<p>We must therefore consider the electric field at each interface, before solving for the intensity both inside and outside.</p>
</section>
<section id="interfaces" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="interfaces"><span class="header-section-number">6.3</span> Interfaces</h2>
<p>Setting the incoming field amplitude to unity, then the value of the field at position one, after one round trip, is the sum of the transmission coefficient and the field travelling in the opposing direction <em>e.g.</em></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> E1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  (w/+ <span class="at">'t1</span> (w/* <span class="at">'r1</span> (w/- <span class="at">'E4</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At position two, the same field has travelled the full length of the cavity, L, and so has picked up a change in phase,</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> phi</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  (w/* <span class="at">'k</span> <span class="at">'L</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, where k is the field wavenumber:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> E2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  (w/* E1 (w/Exp (w/* w/I phi))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. Note how we are able to seamlessly mix Clojure and Wolfram expressions.</p>
<p>At position three, the field undergoes reflection and so now carries an additional reflection coefficient as well as an extra π phase change.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> E3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  (w/* (w/- <span class="at">'r2</span>) E2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By position four, the field has travelled a further distance L and so is now equal to</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> E4</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  (w/* E3 (w/Exp (w/* w/I phi))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. Which we can evaluate and visualise with one of our handy macros.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt;&gt; E4</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>        (w/== <span class="at">'E4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\text{E4}=\text{r2} \left(-e^{2 i k L}\right) (\text{t1}-\text{E4} \text{r1})\]</span></p>
<p>## Fields Using these expressions, we can now calculate the inner, transmitted and reflected fields of the cavity (with some subtle phase assumptions). Note how easy it is to, first of all, form an equation from the symbol ’E4 and the clojure variable E4, and, second of all, to rearrange the equation for a solution.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> e4 </span>(<span class="kw">-&gt;</span> (w/== <span class="at">'E4</span> E4)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>            (w/Solve <span class="at">'E4</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>            w/First w/First))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; e4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\text{E4}\to \frac{\text{r2} \text{t1} e^{2 i k L}}{-1+\text{r1} \text{r2} e^{2 i k L}}\]</span></p>
<p>Substitution and simplification can then be used to arrive at the transmission and reflection, respectively.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> T </span>(<span class="kw">-&gt;</span> (w/x&gt;&gt; (w/* E2 <span class="at">'t2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                  e4)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           w/&gt;&gt;_&lt;&lt;))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt;&gt; T (w/== <span class="at">'T</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[T=\frac{\text{t1} \text{t2} e^{i k L}}{1-\text{r1} \text{r2} e^{2 i k L}}\]</span></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> R </span>(<span class="kw">-&gt;</span> (w/+ (w/* E4 <span class="at">'t1</span>) <span class="at">'r1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>           (w/x&gt;&gt; e4)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>           w/&gt;&gt;_&lt;&lt;</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>           w/Together))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt;&gt; R (w/== <span class="at">'R</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[R=\frac{\text{r1}^2 \text{r2} e^{2 i k L}+\text{r2} \text{t1}^2 e^{2 i k L}-\text{r1}}{-1+\text{r1} \text{r2} e^{2 i k L}}\]</span></p>
</section>
<section id="observables" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="observables"><span class="header-section-number">6.4</span> Observables</h2>
<p>Taking the square of the fields (using the complex conjugate), gives the corresponding observables, <em>i.e.</em> things that can be actually measured.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> I4 </span>(<span class="kw">-&gt;</span> (w/x&gt;&gt; <span class="at">'E4</span> e4) ||<span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>            w/++&lt;_&gt;</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            w/&gt;&gt;_&lt;&lt;))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/== <span class="at">'I4</span> (w/** (w/Abs <span class="at">'E4</span>) <span class="dv">2</span>) I4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\text{I4}=| \text{E4}| ^2=\frac{\text{r2}^2 \text{t1}^2}{-2 \text{r1} \text{r2} \cos (2 k L)+\text{r1}^2 \text{r2}^2+1}\]</span></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> Tsq </span>(<span class="kw">-&gt;</span> T ||<span class="dv">2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             w/++&lt;_&gt;</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>             w/&gt;&gt;_&lt;&lt;))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/== (w/** <span class="at">'T</span> <span class="dv">2</span>) Tsq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[T^2=\frac{\text{t1}^2 \text{t2}^2}{-2 \text{r1} \text{r2} \cos (2 k L)+\text{r1}^2 \text{r2}^2+1}\]</span></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> Rsq </span>(<span class="kw">-&gt;</span> R ||<span class="dv">2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>             w/++&lt;_&gt;</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>             w/&gt;&gt;_&lt;&lt;</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>             w/Together))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/== (w/** <span class="at">'R</span> <span class="dv">2</span>) Rsq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[R^2=\frac{-2 \text{r1}^3 \text{r2} \cos (2 k L)-2 \text{r1} \text{r2} \text{t1}^2 \cos (2 k L)+\text{r1}^4 \text{r2}^2+2 \text{r1}^2 \text{r2}^2 \text{t1}^2+\text{r1}^2+\text{r2}^2 \text{t1}^4}{-2 \text{r1} \text{r2} \cos (2 k L)+\text{r1}^2 \text{r2}^2+1}\]</span></p>
</section>
<section id="observables-with-loss" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="observables-with-loss"><span class="header-section-number">6.5</span> Observables with loss</h2>
<p>The above result is a perfectly reasonable, but simple, model. More realistically, we want to be able to understand mirrors that have losses, <em>i.e.</em> that don’t just reflect or transmit light, but that actually absorb or ‘waste’ light.</p>
<p>This is one of the places that Wolfram really shines. Almost the entire engine is designed around replacement rules. And so we just have to define a substitution, which says that reflection + transmission + loss is equal to 1:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> losses</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  [(w/-&gt; (w/** <span class="at">'r1</span> <span class="dv">2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         (w/+ <span class="dv">1</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>              (w/- <span class="at">'l1</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>              (w/- (w/** <span class="at">'t1</span> <span class="dv">2</span>))))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>   (w/-&gt; (w/** <span class="at">'r2</span> <span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>         (w/+ <span class="dv">1</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>              (w/- <span class="at">'l2</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>              (w/- (w/** <span class="at">'t2</span> <span class="dv">2</span>))))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and substitute these into the equations. We’re going to go a step further however…</p>
</section>
<section id="approximations" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="approximations"><span class="header-section-number">6.6</span> Approximations</h2>
<p>Rather than just substitute the new rule into our expressions, we’re going to take this opportunity to define some other replacement rules. Now so far, we’ve been fairly mathematically pure, but a lot of physics is about knowing when (and being able) to make good approximations.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> approximations</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  [(w/-&gt; (w/* <span class="at">'r1</span> <span class="at">'r2</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         (<span class="kw">let</span> [vars [(w/** <span class="at">'t1</span> <span class="dv">2</span>) (w/** <span class="at">'t2</span> <span class="dv">2</span>) <span class="at">'l1</span> <span class="at">'l2</span>]]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>           (<span class="kw">-&gt;</span>  (w/x&gt;&gt; (w/* (w/√ (w/** <span class="at">'r1</span> <span class="dv">2</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                            (w/√ (w/** <span class="at">'r2</span> <span class="dv">2</span>)))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                       losses)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                (w/Series [<span class="at">'t1</span> <span class="dv">0</span> <span class="dv">2</span>]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                          [<span class="at">'t2</span> <span class="dv">0</span> <span class="dv">2</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                          [<span class="at">'l1</span> <span class="dv">0</span> <span class="dv">2</span>]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                          [<span class="at">'l2</span> <span class="dv">0</span> <span class="dv">2</span>])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                w/Normal</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                w/&lt;&lt;_&gt;&gt;</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                (w/x&gt;&gt; (<span class="kw">mapv</span> #(w/-&gt; <span class="va">%</span> (w/* <span class="at">'temp</span> <span class="va">%</span>)) vars))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                (w/Series [<span class="at">'temp</span> <span class="dv">0</span> <span class="dv">1</span>])</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                w/Normal</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                (w/x&gt;&gt; (w/-&gt; <span class="at">'temp</span> <span class="dv">1</span>)))))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; approximations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\left\{\text{r1} \text{r2}\to \frac{1}{2} \left(-\text{l1}-\text{l2}-\text{t1}^2-\text{t2}^2\right)+1\right\}\]</span></p>
<p>What’s happening here is that we are simplifying the expression for r1<em>r2 by assuming that the transmission and loss for light going through a mirror is small. So small, that higher powers of these variabes are negligible. And so, we substitute the values into the expression, expand the functions in a power series and neglect any higher powers. The neglect is done by inserting <a href="https://mathworld.wolfram.com/Big-ONotation.html">‘big O’ notation</a> and then restricting the series to a single power in that variable. As we want to do this for multiple variables, then we map over each one. This is a complicated mathematical procedure, but Wolframite allows us to do this quite concisely, apart from some necessary Wolfram datatype conversions (</em>e.g.* using the w/Normal function).</p>
</section>
<section id="the-cavity-field" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="the-cavity-field"><span class="header-section-number">6.7</span> The cavity field</h2>
<p>We remember (from part I) that Wolfram can define quite general approximations. With the small angle approximation, and those defined above, we can formulate our final expression for the optical intensity inside the cavity:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> small-angle</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  (w/_&gt; (w/Cos (w/Pattern <span class="at">'x</span> (w/Blank)))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        (w/+ <span class="dv">1</span> (w/* -<span class="fl">1/2</span> (w/** <span class="at">'x</span> <span class="dv">2</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> I4--approx</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  (eval-&gt; I4</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>          (w/x&gt;&gt; (w/-&gt; (w/Cos (w/* <span class="dv">2</span> <span class="at">'k</span> <span class="at">'L</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                       (w/Cos <span class="at">'phi</span>)))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>          (w/x&gt;&gt; approximations)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>          (w/x&gt;&gt; (w/-&gt; (w/** (w/* <span class="at">'r1</span> <span class="at">'r2</span>) <span class="dv">2</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                       (<span class="kw">-&gt;</span> (w/x&gt;&gt; (w/* <span class="at">'r1</span> <span class="at">'r2</span>) approximations)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                           (w/** <span class="dv">2</span>))))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>          (w/x&gt;&gt; (<span class="kw">conj</span> losses small-angle))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>          w/&gt;_&lt;))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt;&gt; I4--approx</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>        (w/== (w/** (w/Abs <span class="at">'E4</span>) <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[| \text{E4}| ^2=\frac{4 \text{t1}^2 \left(-\text{l2}-\text{t2}^2+1\right)}{-2 \left(\phi ^2-2\right) \left(\text{l1}+\text{l2}+\text{t1}^2+\text{t2}^2-2\right)+\left(\text{l1}+\text{l2}+\text{t1}^2+\text{t2}^2-2\right)^2+4}\]</span></p>
</section>
<section id="visualised" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="visualised"><span class="header-section-number">6.8</span> Visualised</h2>
<p>So we finally have an equation for the field inside the cavity. If we were mathematicians, then of course, we might have stopped here. Assuming that it’s only real scientists who’re reading this (shhh!), then the next step is to explore these equations graphically, under practical assumptions.</p>
<p>For this, we will define a few utility functions, that also demonstrate Wolfram’s conciseness.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> linspace</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"A list of n numbers between a and b."</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  [a b n]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [d (<span class="kw">/</span> (<span class="kw">-</span> b a) (<span class="kw">dec</span> n))]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">into</span> []</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>          (<span class="kw">map</span> (<span class="kw">fn</span> [x]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                 (<span class="kw">+</span> a</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">*</span> x d)))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>               (<span class="kw">range</span> n)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> coordinates</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"There's no numpy here, so what do we do? It turns out Wolfram can reimplement a meshgrid-like function very concisely (let's not talk about the performance though...)."</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  [xmin xmax ymin ymax]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  (eval-&gt; (w/Outer w/List</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                   (linspace xmin xmax <span class="dv">100</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                   (linspace ymin ymax <span class="dv">100</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>          (w/Flatten <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> Efield</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"For convenience, we build a clojure function over the Wolfram expression created earlier."</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  [t1 t2 l1 l2 phi]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  (wl/eval (w/Clear <span class="at">'f</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  (wl/eval (w/_= (<span class="kw">list</span> <span class="at">'f</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                       (w/Pattern t1 (w/Blank))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                       (w/Pattern t2 (w/Blank))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                       (w/Pattern l1 (w/Blank))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                       (w/Pattern l2 (w/Blank))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                       (w/Pattern phi (w/Blank)))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                 I4--approx))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  (wl/eval (<span class="kw">list</span> <span class="at">'f</span> t1 t2 l1 l2 phi)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> Efield--transmission-phase</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"This is just a function to reduce the number of variables over which we plot. We can't (easily) plot in 4-D!"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  [[t1 phase]]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  [t1 phase (Efield t1 t1 <span class="fl">20E-6</span> <span class="fl">20E-6</span> phase)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb39"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(wl/eval (w/_= <span class="at">'nums</span> (<span class="kw">mapv</span> Efield--transmission-phase</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                           (coordinates</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                            (math/sqrt <span class="fl">50E-6</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                            (math/sqrt <span class="fl">700E-6</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                            -<span class="fl">0.001</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">0.001</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb40"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(wh/view</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a> (w/ListPlot3D <span class="at">'nums</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>               (w/-&gt; w/PlotRange w/All)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               (w/-&gt; w/Boxed w/False)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>               (w/-&gt; w/AxesLabel</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                     [<span class="st">"Mirror transmission"</span> <span class="st">"Phase"</span> <span class="st">"Intracavity intensity"</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div><details open="open"><summary><h5 style="cursor:pointer;display:inline;padding:0.5rem 1rem 0 1rem;" class="anchored">ListPlot3D[nums, Rule[PlotRange, All], Rule[Boxed, False], Rule[AxesLabel, {"Mirror transmission", "Phase", "Intracavity intensity"}]]</h5></summary><div class="wl-results"><hr><img src="data:image/jpeg;base64,R0lGODlh0AK0AfcFAGZmZrKystnZ2cXFxXl5ef///42Njezs7J+fn0BAQAAAAKCgoL+/v39/f2BgYN/f3yAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICH/C05FVFNDQVBFMi4wAwEAAAAh+QQECgD/ACwAAAAA0AK0AQAI/wALCBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KtKjRo0iTKl3KtKnTp1CjSp1KtarVq1izat3KtavXr2DDih1LtqzZs2jTql3Ltq3bt3Djyp1Lt67du3jz6t3Lt6/fv4ADCx5MuLDhw4gTK17MuLHjx5AjS55MubLly5gza97MubPnz6BDix5NurTp06hTq17NurXr17Bjy55Nu7bt27hz697Nu7fv38CDCx9OvLjx48iTK1/OvLnz59CjS59Ovbr169iza9/Ovbv37+DDi/8fT768+fPo06tfz769+/fw48ufT7++/fv48+vfz7+///8ABijggAQWaOCBCCao4IIMNujggxBGKOGEFFZo4YUYZqjhhhx26OGHIIYo4ogklmjiiSimqOKKLLbo4oswxijjjDTWaOONOOao44489ujjj0AGKeSQRBZp5JFIJqnkkkw26eSTUEYp5ZRUVmnllVhmqeWWXHbp5ZdghinmmGSWaeaZaKap5ppstunmm3DGKeecdNZp55145qnnnnz26eefgAYq6KCEFmrooYgmquiijDbq6KOQRirppJRWaumlmGaq6aacdurpp6CGKuqopJZq6qmopqrqqqy26uqrsMb/KuustNZq66245qrrrrz26uuvwAYr7LDEFmvsscgmq6xtDEDwwEIPOAABBA08u+x7DyiggLUIMaAABA4k8C2316rnrbbkGgSBAgMhoIAD5a7XwLfrpkuQuwgQlAAE8aaXbQMFOLBtQgKTOy8D/Z73gLUFJyQuufgmrF7DCK1bkLsAS4wexQdZfK8CGWtsHscGiXsxyCKfR3JBJn+cb8rlrUzQwQTJDPN3NgvkbcgFeHzzeCQz0ADCBTwwrbXzwvsz0AO3++5A2UKwrwIJLE2e0OQ+0MDLAmmdQAI8W92fAWLXR0DZ9BFAgAEDoA0f2wIsQMACbbu9XgABCHTAAAvY/3133n67JwDZgbd3wNmFtwfA3HUnjh7bfDueHt2Sq4d35ekNjjl6h2/OnNYIEJ3QAwyUbrroAi1OuefGiastygS//nrVBEHeN+vEiQuw1gpwbZDADQQfvO8FGCAA7sV5q3TR0yYk9UKXIz9cxAPRfNDTCmkuvXAkU39y6MGjPtDhB2wfXMsD7XzQvOu+zm9BByxOQOPm74a+zrAXJHACz/K+/EAEOMABblc/+7GLIOozyAN89wBxic94BfTN/QqAMYdYbyDRi+BuBIY67y1kXsSLnAZ3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" style="margin-top:1rem;"></div></details></div>
<p>And there you have it! It turns out that if you get the phase right and you buy high quality mirrors then you can massively amplify the laser light. In fact, if you add a ‘gain’ material in the middle then such light amplification by the stimulated emission of radiation has a catchier name: it’s called a <em>Laser</em>!</p>
</section>
<section id="acknowledgements" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Acknowledgements</h1>
<p>This tutorial was made with the help of Thomas Clark, Jakub Holý and Daniel Slutsky. The cavity field derivation, itself, followed in the footsteps of one Francis ‘Tito’ Williams.</p>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/scicloj/wolframite/blob/main/notebooks/for_scientists/cavity_physics.clj">notebooks/for_scientists/cavity_physics.clj</a></small></small></pre></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./for_scientists.index.html" class="pagination-link" aria-label="Wolframite for scientists I (Introduction)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./for_developers.index.html" class="pagination-link" aria-label="Wolframite for developers">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Wolframite for developers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>