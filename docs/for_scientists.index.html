<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Wolframite for scientists I (Introduction) – Wolframite Documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./for_scientists.cavity_physics.html" rel="next">
<link href="./gotchas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./for_scientists.index.html">Tutorials for scientists</a></li><li class="breadcrumb-item"><a href="./for_scientists.index.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Wolframite Documentation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Wolframite</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quickstart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quickstart</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./understanding_wolframite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Wolframite</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gotchas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Gotchas…</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials for scientists</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_scientists.index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_scientists.cavity_physics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials for developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_developers.index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Wolframite for Clojure developers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_developers.wolfram_for_clojurians.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Brief introduction into Wolfram Language for Clojure developers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./for_developers.demo_analysis_cycling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Using Wolframite to analyse cycle trips data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">FAQ</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract"><span class="header-section-number">5.1</span> Abstract</a></li>
  <li><a href="#motivation---why-on-earth" id="toc-motivation---why-on-earth" class="nav-link" data-scroll-target="#motivation---why-on-earth"><span class="header-section-number">5.2</span> Motivation - Why on earth?</a></li>
  <li><a href="#getting-started-for-scientists" id="toc-getting-started-for-scientists" class="nav-link" data-scroll-target="#getting-started-for-scientists"><span class="header-section-number">5.3</span> Getting Started (for scientists)</a>
  <ul>
  <li><a href="#clojure" id="toc-clojure" class="nav-link" data-scroll-target="#clojure"><span class="header-section-number">5.3.1</span> Clojure</a>
  <ul class="collapse">
  <li><a href="#clojure-physics" id="toc-clojure-physics" class="nav-link" data-scroll-target="#clojure-physics"><span class="header-section-number">5.3.1.1</span> Clojure physics</a></li>
  <li><a href="#clojure-notation" id="toc-clojure-notation" class="nav-link" data-scroll-target="#clojure-notation"><span class="header-section-number">5.3.1.2</span> Clojure notation</a></li>
  </ul></li>
  <li><a href="#data-science" id="toc-data-science" class="nav-link" data-scroll-target="#data-science"><span class="header-section-number">5.3.2</span> Data science</a></li>
  </ul></li>
  <li><a href="#sec-wolfram-basics" id="toc-sec-wolfram-basics" class="nav-link" data-scroll-target="#sec-wolfram-basics"><span class="header-section-number">5.4</span> Wolfram basics</a>
  <ul>
  <li><a href="#lets-define-our-terms" id="toc-lets-define-our-terms" class="nav-link" data-scroll-target="#lets-define-our-terms"><span class="header-section-number">5.4.1</span> Let’s define our terms!</a></li>
  <li><a href="#access-to-knowledge" id="toc-access-to-knowledge" class="nav-link" data-scroll-target="#access-to-knowledge"><span class="header-section-number">5.4.2</span> Access to knowledge</a></li>
  <li><a href="#defining-expressions" id="toc-defining-expressions" class="nav-link" data-scroll-target="#defining-expressions"><span class="header-section-number">5.4.3</span> Defining expressions</a></li>
  <li><a href="#defining-functions" id="toc-defining-functions" class="nav-link" data-scroll-target="#defining-functions"><span class="header-section-number">5.4.4</span> Defining functions</a></li>
  </ul></li>
  <li><a href="#mixing-functions" id="toc-mixing-functions" class="nav-link" data-scroll-target="#mixing-functions"><span class="header-section-number">5.5</span> Mixing functions</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next"><span class="header-section-number">6</span> What’s next?</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="header-section-number">7</span> Acknowledgements</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./for_scientists.index.html">Tutorials for scientists</a></li><li class="breadcrumb-item"><a href="./for_scientists.index.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-scientists" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wolframite for scientists I (Introduction)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="for_scientists.index_files/md-default0.js" type="text/javascript"></script>
<script src="for_scientists.index_files/md-default1.js" type="text/javascript"></script>
<script src="for_scientists.index_files/katex2.js" type="text/javascript"></script>
<p><link href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" rel="stylesheet" type="text/css"></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">ns</span> for-scientists.<span class="kw">index</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"An introduction to the library, that might even be suitable for physicists."</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:require</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   [scicloj.kindly.v4.kind <span class="at">:as</span> k]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   [wolframite.core <span class="at">:as</span> wl]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   [wolframite.impl.wolfram-syms.write-ns <span class="at">:as</span> write]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   [wolframite.tools.hiccup <span class="at">:as</span> wh]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   [wolframite.wolfram <span class="at">:as</span> w]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="abstract" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="abstract"><span class="header-section-number">5.1</span> Abstract</h2>
<p>We introduce you, the motivated scientist (likely the mathematical sort), to using the Wolfram programming language as a Clojure library. Following some brief inspiration (why on earth should you do this?), and getting started notes, we then outline a ‘real’ workflow using the example of optical cavities.</p>
</section>
<section id="motivation---why-on-earth" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="motivation---why-on-earth"><span class="header-section-number">5.2</span> Motivation - Why on earth?</h2>
<p>The Wolfram programming language is ‘best-in-class’ for certain specialist tasks, like manipulating equations, but, as Randall Munroe might have said,</p>
<blockquote class="blockquote">
<p>Wolfram combines the flexibility and power of abstract mathematics with the intuitive clarity of abstract mathematics.</p>
</blockquote>
<p>Clojure, on the other-hand, is a first-class, general-purpose, programming language whose core functions and dynamical, functional, paradigm are well suited to data exploration and manipulation. So why don’t we call Wolfram from Clojure? It seems like the atypical ‘best of both worlds’.</p>
</section>
<section id="getting-started-for-scientists" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="getting-started-for-scientists"><span class="header-section-number">5.3</span> Getting Started (for scientists)</h2>
<p>This tutorial aims to be as comprehensive a reference as possible for the average scientist and, as such, is not concise (and will probably only get longer). For a quick-fire introduction, see <a href="quickstart.html" class="quarto-xref"><span>Chapter 2</span></a>. If the demo is too short and this is too long however, you can always run a ‘search’ on the text for the relevant examples. We won’t judge you!</p>
<section id="clojure" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="clojure"><span class="header-section-number">5.3.1</span> Clojure</h3>
<p>There are many useful online tools for getting started with Clojure. If you’d like to jump straight-in with interactive examples then try the <a href="http://clojurescriptkoans.com/">koans</a>.</p>
<p>For an overview of the language itself, have a look at some of these references:</p>
<ul>
<li><a href="https://ericnormand.me/">Eric Normand’s materials</a> (Guides and video courses for the uninitiated)</li>
<li><a href="https://blog.jakubholy.net/2022/trinity-of-clojure/">Clojure is in fact a trinity…</a> (A short blog post where Jakub argues that to really get Clojure, you have to learn and embrace interactive (REPL-driven) development and structural editing)</li>
<li><a href="https://blog.jakubholy.net/clojure-for-beginners/#_getting_started">Getting started…</a> (More blog posts from Jakub!)</li>
<li><a href="https://www.braveclojure.com/introduction/">Clojure for the Brave and True</a> (An excellent free online, or paid paper, book for learning Clojure)</li>
<li><a href="https://www.amazon.com/Grokking-Simplicity-software-functional-thinking/dp/1617296201">Grokking Simplicity: Taming complex software with functional thinking</a> (Makes no mention of Clojure but is an excellent tool to master functional thinking, which is essential for writing Clojure)</li>
<li><a href="https://github.com/holyjak/interactive-dev-wshop/blob/master/doc/Clojure%20syntax%20intro%20slides-with-notes.pdf">Syntax</a> (A quick reminder of the key syntax.)</li>
</ul>
<section id="clojure-physics" class="level4" data-number="5.3.1.1">
<h4 data-number="5.3.1.1" class="anchored" data-anchor-id="clojure-physics"><span class="header-section-number">5.3.1.1</span> Clojure physics</h4>
<p>If you’d like to see why a physicist might be interested in Clojure then have a look at the video below.</p>
<iframe allowfullscreen="allowfullscreen" src="https://www.youtube.com/embed/SE5Ge4QP4oY"></iframe>
</section>
<section id="clojure-notation" class="level4" data-number="5.3.1.2">
<h4 data-number="5.3.1.2" class="anchored" data-anchor-id="clojure-notation"><span class="header-section-number">5.3.1.2</span> Clojure notation</h4>
<p>For those who are still fairly new to clojure, the first thing to get used to is the style of notation. It might seem strange at first, but a functional LisP can be more efficient (symbolically) than a lot of object-oriented languages and even standard mathematical notation. For example, why write 1+1+1+2 and not (+ 1 1 1 2)? They have around the same number of characters and yet even here it’s arguable that the signal to noise ratio is higher for the second one. Where the second form really shines however, is in it’s scalability. As soon as you add another operator, e.g.&nbsp;1+1+1+2/3, we have a problem. Okay so you made it through primary school and know that 1+1+1+2/3 is really 1+1+1+(2/3) and not (1+1+1+2)/3, but the mental complexity is still there, you’re just used to it. If we introduce another operator, e.g.&nbsp;1+1+1+2✝3, now what do you do? The truth is that if we stick to one simple rule, i.e.&nbsp;use brackets, then we completely solve a whole range of problems in advance, with the ‘cost’ of having to write two characters. In fact, although it might not be obvious, the Wolfram language is actually inspired by/built on the LisP syntax (underneath). The outer layer is just to make it look more like the inefficient notation that mathematicians already know and love…</p>
<p>In summary, <a href="https://en.wikipedia.org/wiki/Order_of_operations#Mnemonics">BODMAS</a> is six rules and incomplete. (function argument …) is a single rule and complete. Be kind to yourself, just write (+ 1 1 1 (/ 2 3)) :).</p>
<p>If you’re still unconvinced about the benefits of a simple syntax then remember that LisP is a programmable programming language: and it’s the syntax that delivers <a href="http://lists.warhead.org.uk/pipermail/iwe/2005-July/000130.html">macros</a>.</p>
</section>
</section>
<section id="data-science" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="data-science"><span class="header-section-number">5.3.2</span> Data science</h3>
<p>If you’re sold on Clojure and interested in problems close to data science then an overview of some of the key analysis libraries can be found here. Be careful though, this is a rapidly evolving area! For up-to-date recommendations, consider the <a href="https://scicloj.github.io/">scicloj website</a> and the data science <a href="https://clojurians.zulipchat.com/#narrow/stream/151924-data-science">zulip channel</a>.</p>
<iframe allowfullscreen="allowfullscreen" src="https://www.youtube.com/embed/MguatDl5u2Q"></iframe>
<p>If you’re really ready to use Wolfram though, then read on!</p>
</section>
</section>
<section id="sec-wolfram-basics" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-wolfram-basics"><span class="header-section-number">5.4</span> Wolfram basics</h2>
<section id="lets-define-our-terms" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="lets-define-our-terms"><span class="header-section-number">5.4.1</span> Let’s define our terms!</h3>
<p>One of the really nice things about using Wolfram as a library is that our middle man (Wolframite) can provide default substitutions to simplify verbose terms, e.g.&nbsp;<code>'(Power x 2)</code> can become <code>'(** x 2)</code> or even <code>'(**2 x)</code>, for readability. What’s even nicer however, is that we can make our own aliases at runtime: the choice is ours!</p>
<p>We mention this now because the best time to define our terms is before we start. The first few aliases give us an insight into how I would have designed Wolfram. The last two go a step further. Here, we make use of Clojure’s modernity and decision to support a much wider character set than Wolfram. Depending on your editor, it can be just as easy to enter these unicode characters as typing the long function name, but the real win is in the readability. Remember, we read our documents far more often than we write them (even if it’s just peer review…).</p>
<p>Therefore, we enter the following.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> aliases </span><span class="co">; </span><span class="al">NOTE</span><span class="co">: These aliases are already included by default</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  '{** Power</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    ++ Conjugate</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    x&gt; Replace</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    x&gt;&gt; ReplaceAll</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    &lt;_&gt; Expand</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    &lt;&lt;_&gt;&gt; ExpandAll</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ++&lt;_&gt; ComplexExpand</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    &gt;_&lt; Simplify</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    &gt;&gt;_&lt;&lt; FullSimplify</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    ⮾ NonCommutativeMultiply</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    √ Sqrt</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    ∫ Integrate})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(wl/restart! {<span class="at">:aliases</span> aliases})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:status</span> <span class="at">:ok</span>, <span class="at">:wolfram-version</span> <span class="fl">14.1</span>, <span class="at">:start</span>!ed? <span class="va">true</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can define new aliases by simply listing any Clojure-allowed symbol in the above map, with a corresponding symbol that represents a Wofram value (function or constant). This works fine, but these are only symbol replacements and so you would need to <em>use</em> them as symbols, <em>e.g.</em> <code>'(** 2 3)</code>. Here, <code>'x</code> is simpler syntax for <code>(quote x)</code>, which simply creates and uses a ‘literal’ symbol <code>x</code>, <em>i.e.</em> <code>'x</code> is not evaluated to anything else.</p>
<p>In this case however, we can’t benefit from using these entities in threading macros (<em>e.g.</em> <code>(-&gt; 'x '(Power 2))</code> would fail) or from editor autocompletion. In general, we would rather have dedicated Clojure functions for these symbols (<em>c.f.</em> <code>(-&gt; 'x (w/Power 2))</code>). For the best experience therefore, we recommend using <code>write-ns!</code>, which helps us to more deeply <em>Clojure-ize</em> these Wolfram functions.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">comment</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (write/write-ns! <span class="st">"src/wolframite/wolfram.clj"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   {<span class="at">:aliases</span> aliases}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using this command, we can generate a full namespace at the given location in your project (shadowing the one from Wolframite) and so refer to the new symbol aliases more directly. The command appears here in a comment block to avoid unnecessary recomputation. See the ‘Literate programming’ section for an explanation.</p>
</section>
<section id="access-to-knowledge" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="access-to-knowledge"><span class="header-section-number">5.4.2</span> Access to knowledge</h3>
<p>With the recent emergence of ChatGPT and similar AI systems, direct access to knowledge from free-form linguistic input is in demand. Wolfram was an early pioneer of this, launching its product, Wolfram|Alpha, in 2009. Wolfram occupies a different space however, focusing mainly on what it describes as ‘computational knowledge’. Rather than strictly using an LLM, it combines its knowledge databases with the ability to perform Wolfram operations on the retrieved data, before returning the result.</p>
<p>For example, we can make both knowledge-based requests and perform complicated calculations on demand (requires internet access).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(wh/view (w/WolframAlpha <span class="st">"What is the mass of 5 rubidium atoms?"</span> <span class="st">"Result"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div><details open="open"><summary><h5 style="cursor:pointer;display:inline;padding:0.5rem 1rem 0 1rem;" class="anchored">WolframAlpha["What is the mass of 5 rubidium atoms?", "Result"]</h5></summary><div class="wl-results"><hr><img src="data:image/jpeg;base64,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" style="margin-top:1rem;"></div></details></div>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(wh/view (w/WolframAlpha <span class="st">"What is the relativistic momentum of a 0.8c electron?"</span> <span class="st">"Result"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div><details open="open"><summary><h5 style="cursor:pointer;display:inline;padding:0.5rem 1rem 0 1rem;" class="anchored">WolframAlpha["What is the relativistic momentum of a 0.8c electron?", "Result"]</h5></summary><div class="wl-results"><hr><img src="data:image/jpeg;base64,R0lGODlhHgEhAPeBAAAAAAgICBAQEBsbG0dHR1VVVX9rVGZmZmlpaW5ubnJycnZ2dnl5eX5+foBsVoJvWINwWoRwWoVyXId0Xol2YYt5ZIx6Zo99aZB/a5F/bJKBbpSDcJWEcZeGdJmJdpqKeJuMepyMep6OfZ+Qf4CAgISEhImJiY6OjpCQkJaWlpmZmaGSgaKUg6OUhKWWhqaZiaiaiqmbjKqdjqyfkK6hk6+ilLCjlbGll7OnmbSom7Wqnbesn6enp6urq7muobqwo7uxpb2ypr60qLKysra2trm5uby8vMC3q8G3rMK5rsS7sca9sse+tMi/tcjAtsvDuczEu87Gvc/Iv8bGxsvLy87OztHKwtPMxNTOxtbPyNfRytjSy9nTzNrVztPT09TU1NvW0NzW0N3Y0t/a1Nra2t7e3uDb1uHc1+Le2eTg2+Xi3ePj4+fk4Ofn5+nm4urn5Ovo5Ozq5urq6u3r6O7s6e7u7vDu6/Hv7fLx7vLx8fTz8fX08vf29fj39vj49vr6+fz8+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQECgD/ACwAAAAAHgEhAAAI/wADCRxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KNBCg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" style="margin-top:1rem;"></div></details></div>
<p>In each case, Wolfram does not just provide the answer, but returns the data in different formats and units in an attempt to anticipate different usecases. This verbosity might seem frustrating, but of course adds flexibility: leaving the user free to filter or present the results in any way that they wish. Here, we have used the last argument to simply display the core ‘Result’.</p>
</section>
<section id="defining-expressions" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="defining-expressions"><span class="header-section-number">5.4.3</span> Defining expressions</h3>
<p>Rather than just querying the Wolfram servers however, the vast majority of people who use this library will want to write their own programs.</p>
<p>For those coming from Mathematica (the official, graphical front-end for the Wolfram language), a good place to start is defining expressions.</p>
<p>This is where the main cost of ‘Wolfram as a library’ lies. In a Wolfram environment, all non-language characters are treated as global symbols by default. This works well for symbol and expression manipulation (Mathematica’s assumed raison d’être), but not for any other purpose. To successfully embed Wolfram expressions into a general purpose programming language we must make choices.</p>
<p>In this library, there are two approaches. For all official functions, the cleanest way of referring to them is to import the base symbol namespace, i.e.&nbsp;wolframite.wolfram, or a customized one, e.g.&nbsp;‘wolframite.wolfram-extended’. This allows the user to manipulate expressions like other clojure functions (and to access the associated Wolfram documentation from your editor) e.g.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> <span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    (w/Power <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    (w/Subtract <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(Subtract (Power <span class="dv">2</span> <span class="dv">1</span>) <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To calculate/retrieve the result we then simply add ‘eval’ from the Wolframite core namespace:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> <span class="dv">2</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    (w/Power <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    (w/Subtract <span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    wl/eval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To deal with general symbols, we return to one of LisPs’ strengths: controlled evaluation. Historically necessitated by LisPs’ ‘code-as-data’ paradigm, all LisPs can deal with general symbols by simply not evaluating them. This makes it easy to create and manipulate arbitrary Wolfram expressions, as we can simply treat them as unevaluated symbols (note our use of the new aliases too).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> <span class="at">'x</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    (w/** <span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    (w/- <span class="at">'5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    wl/eval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">+</span> -<span class="dv">5</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This comes at the cost of having to ‘mark’ symbols, lists and functions manually, but it’s a choice between being unevaluated by default (e.g.&nbsp;Wolfram, Maple), unevaluated when marked (LisPs) or no easy way to work with symbols (the vast majority of programming languages). It also comes at the cost of some ‘gotchas’ (listed elsewhere in the docs), but these are avoided for the most part by using a wolframite.wolfram namespace (and ‘write-ns!’ function), as introduced in the beginning.</p>
</section>
<section id="defining-functions" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="defining-functions"><span class="header-section-number">5.4.4</span> Defining functions</h3>
<p>Functions are slightly more complicated. Functions can be defined in many different ways. The easiest way is to keep functions, where appropriate, as standard Clojure expressions.</p>
<p>If you’re used to using Wolfram/Mathematica, then f[x_]:=x^2 is simply</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> f </span>[x] (wl/eval (w/Power x <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(f <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(f <span class="at">'x</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(** x <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. If instead you want to define functions inside the Wolfram kernel, and attach them to arbitrary symbols, then the most ergonomic way is</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(wl/eval (w/_= <span class="at">'f</span> (w/fn [x] (w/** x <span class="dv">2</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(wl/eval '(f <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, where ’_=’ is the Wolframite version of ‘:=’ (SetDelayed). See the ‘Gotchas’ section (<a href="gotchas.html" class="quarto-xref"><span>Chapter 4</span></a>) for why. Rather than a direct alias, w/fn is a special form that allows you to define Wolfram functions in a convenient way. Note that ‘f’ is a new symbol and therefore cannot be expected to be part of wolframite.wolfram or similar namespaces. Therefore, we must call the function using an unevaluated Clojure list.</p>
<p>In my opinion, this mixes the best of Wolfram and Clojure: and scales well. The most explicitly Wolfram way of doing it however, is to write</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(wl/eval (w/Clear <span class="at">'f</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(wl/eval '(_= (f (Pattern x (Blank))) (Power x <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(wl/eval '(f <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, where we first removed all definitions from ‘f’ before reassigning the function.</p>
<p>Once you can define your own aliases and create arbitrary expressions and functions, then you’re basically good to go.</p>
</section>
</section>
<section id="mixing-functions" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="mixing-functions"><span class="header-section-number">5.5</span> Mixing functions</h2>
<p>Wolframite is not just a different way to typeset Wolfram functions. Indeed, there would be very little point in building an entire library around this. Instead, Wolframite wants to help the user bring Wolfram’s functions into a general Clojure workflow, i.e.&nbsp;to mix Clojure and Wolfram together, such that there is another, potentially better way, to do science.</p>
<p>Such is the case, we can demonstrate a new workflow. As noted above, it is straightforward to define functions in Wolframite, as in Wolfram/Mathematica.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> </span>||<span class="dv">2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The intensity: the value times the conjugate of the value or, equivalently, the absolute value squared."</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  [x]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  (w/* x (w/++ x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (w/* <span class="dv">3</span> w/I)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    (w/+ <span class="dv">5</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    ||<span class="dv">2</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    wl/eval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dv">34</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we make a shorthand, the absolute value squared. Defined as a clojure function, it simply abstracts two Wolfram operations, which can then be used alongside others.</p>
<p>And yet there are two meaningful improvements already. First of all, we can, <a href="https://ask.clojure.org/index.php/11627/the-pipe-char-considered-valid-symbol-constituent-character">currently</a>, use more mathematical characters in Clojure, such that even the raw code can approach familiar symbolic maths. Second of all, we can exploit Clojure’s ‘threading’ features. In my view, chaining Wolfram function calls together with threading macros is actually a big usability improvement. Wolfram expressions can get pretty involved (it’s common to end up with expressions that hold 10s of symbols and operators and 100s are not unheard of) and trying to read these from the inside out is just not natural for the average human. It stands to reason then that chaining functions together (and debugging them!) can really be a pain. In fact, Wolfram recognised this problem when it introduced the prefix operator, ‘@’, to help with function composition, e.g.&nbsp;f@g<span class="citation" data-cites="h">@h</span>. Unfortunately however, this doesn’t work with multiple arguments. It is possible to do things like f@<span class="citation" data-cites="args">@args</span>, and even things like f@@@{{a, b}, {c, d}}, but the readability quickly becomes dire. On the other hand, Clojure’s threading is simple, clear and scalable.</p>
<p>In fact, a little Clojure goes a long way. Look how easily we can add UX conveniences to our workflow.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> eval-&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the threading macro to automatically pass the result to wolframite eval."</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;</span> <span class="at">~@xs</span> wl/eval))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> TeX</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UX fix. Passes the Wolfram expression to ToString[TeXForm[...]], as the unsuspecting coder might not realise that 'ToString' is necessary."</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  [tex-form]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  (w/ToString (w/TeXForm tex-form)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> TeX-&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extends the thread-first macro to automatically eval and prepare the expression for TeX display."</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  [&amp; xs]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  `(<span class="kw">-&gt;</span> <span class="at">~@xs</span> TeX wl/eval k/tex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>N.B. for those who’re still new, <code>&amp;</code> introduces the <a href="https://clojure.org/reference/special_forms">rest</a> parameter. This collects together all of the arguments given to the function after this point into a list called <code>xs</code>, <em>i.e.</em> all of the arguments in these cases. Another special form is <code>~@xs</code>. This is what <a href="https://clojuredocs.org/clojure.core/unquote-splicing">splices</a> the arguments into the symbol expression.</p>
<p>With our new code, suddenly Wolfram-like nesting, <em>e.g.</em></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(k/tex (wl/eval (TeX (||<span class="dv">2</span> (w/+ (w/* <span class="at">'x</span> w/I) <span class="at">'y</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[(y+i x) \left(y^*-i x^*\right)\]</span></p>
<p>becomes</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/* <span class="at">'x</span> w/I)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>       (w/+ <span class="at">'y</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>       ||<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[(y+i x) \left(y^*-i x^*\right)\]</span></p>
<p>. Can you spot the difference :)? The result is the same, but the operation chaining is much cleaner and the Wolfram evaluation and preparation for TeX rendering has been swept under the carpet. Of course, function composition and abstraction is well supported in Wolfram, but here simple macros have allowed us to make changes at the level of the language.</p>
<p>It’s just a small example, but LisP is designed for metaprogramming and so the sky’s the limit when it comes to building more features around Wolfram functions. A sceptical reader may point out that eval and display are solved problems within the Mathematica system, but in my opinion there are solid reasons for not wanting to be confined to a specific IDE. Have a look at ‘Why literate programming?’ in the FAQs (<a href="faq.html" class="quarto-xref"><span>Chapter 11</span></a>) for more details.</p>
<p>Before we finish this part of the tutorial, let’s consider a (slightly) more realistic example.</p>
<p>Wolfram can be used to define quite general approximations, using the ‘Pattern’ system. For example, let us assume that we want to expand Cos(x) as a polynomial when x is small. First, we need to know what the expansion is. We can actually find out by using Wolfram! i.e.&nbsp;</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(eval-&gt; (w/Series (w/Cos <span class="at">'x</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  [<span class="at">'x</span> <span class="dv">0</span> <span class="dv">2</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        w/Normal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">+</span> <span class="dv">1</span> (<span class="kw">*</span> -<span class="fl">1/2</span> (** x <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we know (or have remembered!) the form, we can create a general rule that is not limited to specific symbol definitions:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> small-angle</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  (w/_&gt; (w/Cos (w/Pattern <span class="at">'x</span> (w/Blank)))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        (w/+ <span class="dv">1</span> (w/* -<span class="fl">1/2</span> (w/** <span class="at">'x</span> <span class="dv">2</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, where we have made use of Clojure’s native support for ratios. The rule can now be named and used for any Cos function with any argument. Which of course looks much nicer using TeX.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/x&gt;&gt; (w/Cos <span class="at">'phi</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>              small-angle))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[1-\frac{\phi ^2}{2}\]</span></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(TeX-&gt; (w/x&gt;&gt; (w/Cos (w/+ <span class="dv">1</span> <span class="at">'phi</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>              small-angle))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[1-\frac{1}{2} (\phi +1)^2\]</span></p>
</section>
<section id="whats-next" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> What’s next?</h1>
<p>Okay, so that was a lot of introduction. If you read all of that in one sitting then remember to take a break. Put the kettle on; do some press-ups and then sit-down for a worked example (Cavity Physics).</p>
</section>
<section id="acknowledgements" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Acknowledgements</h1>
<p>This tutorial was made with the help of Thomas Clark, Jakub Holý and Daniel Slutsky.</p>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/scicloj/wolframite/blob/main/notebooks/for_scientists/index.clj">notebooks/for_scientists/index.clj</a></small></small></pre></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./gotchas.html" class="pagination-link" aria-label="Gotchas...">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Gotchas…</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./for_scientists.cavity_physics.html" class="pagination-link" aria-label="Wolframite for scientists II (Cavity physics)">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Wolframite for scientists II (Cavity physics)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>